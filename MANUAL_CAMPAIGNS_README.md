# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä—É—á–Ω—ã—Ö —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π

## –û–ø–∏—Å–∞–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π, —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –≤—Ä—É—á–Ω—É—é –≤ Ozon Performance, —Å —Ü–µ–ª—å—é –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∫–∞–º–ø–∞–Ω–∏–π.

## –ù–æ–≤–∞—è –º–æ–¥–µ–ª—å: ManualCampaign

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è:
- `name` - –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏
- `offer_id` - Offer ID —Ç–æ–≤–∞—Ä–∞
- `sku` - SKU —Ç–æ–≤–∞—Ä–∞
- `ozon_campaign_id` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∫–∞–º–ø–∞–Ω–∏–∏ –≤ Ozon
- `week_budget` - –Ω–µ–¥–µ–ª—å–Ω—ã–π –±—é–¥–∂–µ—Ç
- `daily_budget` - –¥–Ω–µ–≤–Ω–æ–π –±—é–¥–∂–µ—Ç
- `total_budget` - –æ–±—â–∏–π –±—é–¥–∂–µ—Ç
- `state` - —Å—Ç–∞—Ç—É—Å –∫–∞–º–ø–∞–Ω–∏–∏ (–∞–∫—Ç–∏–≤–Ω–∞, –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞, –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞, –∑–∞–≤–µ—Ä—à–µ–Ω–∞)
- `payment_type` - —Ç–∏–ø –æ–ø–ª–∞—Ç—ã (CPO, CPC, CPM)
- `adv_object_type` - —Ç–∏–ø —Ä–µ–∫–ª–∞–º–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ (SKU, –∫–∞—Ç–µ–≥–æ—Ä–∏—è)
- `from_date` / `to_date` - –¥–∞—Ç—ã –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è
- `placement` - –º–µ—Å—Ç–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è (JSON)
- `created_at` / `updated_at` - –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:
- `product_autopilot_strategy` - —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –∞–≤—Ç–æ–ø–∏–ª–æ—Ç–∞
- `product_campaign_mode` - —Ä–µ–∂–∏–º –∫–∞–º–ø–∞–Ω–∏–∏
- `auto_increase_percent` - –ø—Ä–æ—Ü–µ–Ω—Ç –∞–≤—Ç–æ—É–≤–µ–ª–∏—á–µ–Ω–∏—è –±—é–¥–∂–µ—Ç–∞
- `auto_increased_budget` - –∞–≤—Ç–æ—É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π –±—é–¥–∂–µ—Ç
- `is_auto_increased` - –≤–∫–ª—é—á–µ–Ω–æ –ª–∏ –∞–≤—Ç–æ—É–≤–µ–ª–∏—á–µ–Ω–∏–µ
- `recommended_auto_increase_percent` - —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç –∞–≤—Ç–æ—É–≤–µ–ª–∏—á–µ–Ω–∏—è

## –ù–æ–≤—ã–π —Ç–∞—Å–∫: sync_manual_campaigns

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
1. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é `get_store_performance_token(store)` –∏–∑ `utils.py`
2. **–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–π** - –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ API Ozon Performance –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –∫–∞–º–ø–∞–Ω–∏–π
3. **–ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –∫–∞–º–ø–∞–Ω–∏–∏** - –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞–º–ø–∞–Ω–∏–∏ –ø–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤/SKU
4. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - —Å–æ–∑–¥–∞–µ—Ç –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∑–∞–ø–∏—Å–∏ –≤ –º–æ–¥–µ–ª–∏ ManualCampaign
5. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤–µ–¥–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞:
–¢–∞—Å–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤:
```python
from .utils import get_store_performance_token
token_info = get_store_performance_token(store)
access_token = token_info.get("access_token")
```

–¢–æ–∫–µ–Ω –ø–æ–ª—É—á–∞–µ—Ç—Å—è –ø–æ –ø–æ–ª—è–º –º–∞–≥–∞–∑–∏–Ω–∞:
- `store.performance_client_id`
- `store.performance_client_secret`

### API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:
- `GET /api/client/campaign` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–∞–º–ø–∞–Ω–∏–π
- `GET /api/client/campaign/{campaignId}/objects` - –ø–æ–ª—É—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –∫–∞–º–ø–∞–Ω–∏–∏

### –ó–∞–ø—É—Å–∫ —Ç–∞—Å–∫–∞:
```python
# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤
from ozon.tasks import sync_manual_campaigns
sync_manual_campaigns.delay()

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞
sync_manual_campaigns.delay(store_id=1)
```

## –ê–¥–º–∏–Ω–∫–∞ Django

–ú–æ–¥–µ–ª—å ManualCampaign –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ Django –∞–¥–º–∏–Ω–∫–µ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:
- **–¢–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è** - —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ
- **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ–ª–µ–π** - —É–¥–æ–±–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
- **–§–∏–ª—å—Ç—Ä—ã** - –ø–æ —Å—Ç–∞—Ç—É—Å—É, —Ç–∏–ø—É –æ–ø–ª–∞—Ç—ã, –º–∞–≥–∞–∑–∏–Ω—É, –¥–∞—Ç–∞–º
- **–ü–æ–∏—Å–∫** - –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, ID –∫–∞–º–ø–∞–Ω–∏–∏, SKU, offer_id

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–∞–º–ø–∞–Ω–∏–π:
```python
from ozon.models import ManualCampaign

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ –∫–∞–º–ø–∞–Ω–∏—è –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ SKU
existing_campaign = ManualCampaign.objects.filter(
    sku=12345,
    state__in=[ManualCampaign.CAMPAIGN_STATE_ACTIVE, ManualCampaign.CAMPAIGN_STATE_PAUSED]
).first()

if existing_campaign:
    print(f"–ö–∞–º–ø–∞–Ω–∏—è —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: {existing_campaign.name}")
    # –ó–∞–ø—Ä–µ—â–∞–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–∞–º–ø–∞–Ω–∏–∏
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ ozon_campaign_id:
```python
# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ ID –∫–∞–º–ø–∞–Ω–∏–∏ –≤ Ozon
campaign_exists = ManualCampaign.objects.filter(
    ozon_campaign_id="48852"
).exists()

if campaign_exists:
    print("–ö–∞–º–ø–∞–Ω–∏—è —Å —Ç–∞–∫–∏–º ID —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –±–∞–∑–µ")
```

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–¢–∞—Å–∫ –≤–µ–¥–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏:
- `[‚ñ∂Ô∏è]` - –Ω–∞—á–∞–ª–æ –æ–ø–µ—Ä–∞—Ü–∏–∏
- `[‚úÖ]` - —É—Å–ø–µ—à–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
- `[üîÑ]` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∑–∞–ø–∏—Å–∏
- `[‚ö†Ô∏è]` - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- `[‚ùå]` - –æ—à–∏–±–∫–∏
- `[üìä]` - –∏—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ** –≤ –∞–¥–º–∏–Ω–∫–µ
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** –æ—Ç API
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö
- **–¢–∞–π–º–∞—É—Ç—ã** –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º—ã —Ç–æ–∫–µ–Ω–æ–≤**

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Django 3.2+
- Celery –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö —Ç–∞—Å–∫–æ–≤
- requests –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- –î–æ—Å—Ç—É–ø –∫ Ozon Performance API
- –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø–æ–ª—è `performance_client_id` –∏ `performance_client_secret` –≤ –º–æ–¥–µ–ª–∏ `OzonStore`

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:
```bash
cd backend
python ../test_manual_campaigns.py
```

–°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç:
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ —Ä–∞–±–æ—Ç—É –º–æ–¥–µ–ª–∏
- –í–∞–ª–∏–¥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö
- –ó–∞–ø—Ä–æ—Å—ã –∫ –º–æ–¥–µ–ª–∏
- –ò–º–ø–æ—Ä—Ç —Ç–∞—Å–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –ù–∞–ª–∏—á–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–æ–ª–µ–π –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞

## –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** - –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
2. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –æ –Ω–æ–≤—ã—Ö —Ä—É—á–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏—è—Ö
3. **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞** —Ä—É—á–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π
4. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** —Å —Å–∏—Å—Ç–µ–º–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∫–∞–º–ø–∞–Ω–∏–π
5. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤** –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
