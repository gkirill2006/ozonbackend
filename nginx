server {
    server_name checkyourstore.online;
        client_max_body_size 100M;
    # üì¶ –§—Ä–æ–Ω—Ç (Vue)
    root /home/markets/ozonadminpanel/dist;
    index index.html;

    location / {
        try_files $uri /index.html;
    }
location = /index.html {
    add_header Cache-Control "no-cache, no-store, must-revalidate";
    try_files $uri /index.html;
}

location /assets/ {
    add_header Cache-Control "public, max-age=31536000, immutable";
}

# –ê–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç –∏ –ø—Ä–æ—á–∏–µ Django –º–∞—Ä—à—Ä—É—Ç—ã

    # ‚úÖ Django admin
    location /admin/ {
        proxy_pass http://127.0.0.1:9006;  # —Ç–æ—Ç –∂–µ –ø–æ—Ä—Ç, —á—Ç–æ –∏ –¥–ª—è API
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
    # üîÅ –ü—Ä–æ–∫—Å–∏ –Ω–∞ Django API
    location /api/ {
        proxy_pass http://127.0.0.1:9006;  # –ø–æ—Ä—Ç –∏–∑ docker-compose
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    location /auth/ {
        proxy_pass http://127.0.0.1:9006;  # –ø–æ—Ä—Ç –∏–∑ docker-compose
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
    # üñºÔ∏è –ú–µ–¥–∏–∞-—Ñ–∞–π–ª—ã Django
    location /media/ {
        alias /home/markets/ozonbackend/backend/media/;
    }

    # üßæ –°—Ç–∞—Ç–∏–∫–∞ Django (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞)
    location /static/ {
        alias /home/markets/ozonbackend/backend/staticfiles/;
    }
    # ‚ö° –°–∂–∞—Ç–∏–µ
    gzip on;
    gzip_types text/plain text/css application/json application/javascript;

}


server {
    if ($host = checkyourstore.online) {
        return 301 https://$host$request_uri;
    } # managed by Certbot


    server_name checkyourstore.online;
    listen 80;
    return 404; # managed by Certbot


}